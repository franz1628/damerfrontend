<div class="row">
  <div class="col-md-12">
    <form [formGroup]="models">
      <div formArrayName="modelos">
        <table class="table text-center table-sm">
          <thead class="table-success fs-6">
            <tr>
              <th>Item</th>
              <th>Valor 1 </th>

              <!-- <th>Condicion</th> -->
              <th>Valor2</th>
              <th>Acciones</th>
            </tr>

          </thead>
          <tbody>
            @if (modelosArray.controls.length!=0) {
            @for (model of modelosArray.controls; track $index) {
            <tr [formGroupName]="$index" (click)="elegir($index)" [ngClass]="{'selected-row': $index === selectIndex}">
              <td> <label class="mt-2">{{model.get('id')?.value}}</label> </td>

              <td>

                <select class="form-select form-select-sm" formControlName="valor1" (change)="eligeValor($event)">
                  <option value="0">SELECCIONAR</option>
                  <option value="-1">SKU</option>
                  <option value="-2">SKU PADRE</option>
                  @for (atr of categoriaAtributoTecnicos; track $index) {
                  <option value={{atr.AtributoTecnicoVariedad.id}}>{{atr.AtributoTecnicoVariedad.descripcion}}</option>
                  }

                </select>

   
              </td>

              <!-- <td>
                <select class="form-select form-select-sm" formControlName="condicion">
                    <option value="0">SELECCIONAR</option>
                    <option value="1">&gt;</option>
                    <option value="2">&lt;</option>
                    <option value="3">&le;</option>
                    <option value="4">&ge;</option>
                    <option value="5">=</option>
                </select>
              
              </td> -->

              <td>
                <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton{{$index}}" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
                  Selecciona opciones
                </button>
                <ul class="dropdown-menu"  [attr.aria-labelledby]="'dropdownMenuButton' + $index">
                  <li>
                    

                      @if(model.get('valor1')?.value>0){
                   
                        @for (atr of atributosTecnicoVariedadValorsEl; track $index) {
                     
    
                        <div class="form-check m-1">
                          <input class="form-check-input" type="checkbox" value={{atr.id}} id="f{{atr.id}}{{$index}}">
                          <label class="form-check-label" for="f{{atr.id}}{{$index}}">
                            {{atr.valor}}
                          </label>
                        </div>

                      
                        }
                      }@else if(model.get('valor1')?.value==0){
                        
                      }@else{
                        @for (sku of skusEl; track $index) {
                         
    
                          <div class="form-check m-1">
                            <input class="form-check-input" type="checkbox" value={{sku.id}} id="fl{{sku.id}}{{$index}}">
                            <label class="form-check-label" for="fl{{sku.id}}{{$index}}">
                              {{sku.id + ' - ' + sku.descripcion}}
                            </label>
                          </div>
                          
                        }
                       
                      }

                  </li>
                </ul>
 
              </td>

              <td>
                <div class="btn-group">

                  @if(model.get('id')?.value!=0){
                  <button class="btn btn-sm btn-info btn-sm" (click)="editModel($index)"><i
                      class="bi bi-pencil"></i></button>
                  <button class="btn btn-sm btn-danger btn-sm" (click)="delete($index)"><i
                      class="bi bi-trash-fill"></i></button>
                  @if(modelosArray.controls.length==$index+1){
                  <button class="btn btn-sm btn-primary btn-sm" (click)="add()"><i class="bi bi-plus-lg"></i></button>
                  }
                  }@else{
                  <button class="btn btn-sm btn-success btn-sm" (click)="save($index)"><i
                      class="bi bi-save2"></i></button>
                  }
                </div>



              </td>
            </tr>
            }

            }

          </tbody>
        </table>
      </div>

    </form>
  </div>
</div>